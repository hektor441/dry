
eq X X = t.
eq X Y = f.

asserteq X X = out t.
asserteq X Y = error (strs X (strs !! Y)).

X ~ Y = asserteq X Y.

# --- SINGLE WORD REDUCTIONS --- .

alpha = beta.

# --- PREFIX ARG REDUCTIONS --- .

prefix ARG1 ARG2 = effect (prefix ARG1) (prefix ARG2).

prefix ARG = effect ARG.


effect (effect ARG) = double effect ARG.

effect (effect ARG1) (effect ARG2) = effect ARG1 ARG2.
effect ARG1 (effect ARG2) = effect (prefix ARG1) ARG2.
effect (effect ARG1) ARG2 = effect ARG1 (prefix ARG2).


alpha ~ beta.

(prefix a)     ~ (effect a).
(prefix alpha) ~ (effect beta).

(prefix (prefix a)) ~ (double effect a).

(prefix a b) ~ (effect a b).
(prefix alpha beta) ~ (effect beta beta).


not t = f.
not f = t.

zeql X (X T) = t.
zeql X (Y T) = f.

(k X Y) X F = t.
(k X Y) Z G = f.

meql X (A B) X = t.
meql X (A B) Y = f.

out (zeql x (x y)).
out (not (zeql x (y y))).

out ((k x y) x t).
out (not ((k x y) dxsdsx r)).

out (meql x (y z) x).
out (not (meql x (y z) y)).


g = (eq t t) d.

out g.